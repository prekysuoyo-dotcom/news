<script>
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyl7U_VQkbeJGDZiKcZs3339d1BXKxF9ObjX7tFBuKd9_UtiOE6cvQE_Ph-8zr3hlxn/exec?feed=news";

  async function loadNews() {
    const loader = document.getElementById('loader');
    const cont = document.getElementById('slides');
    
    try {
      // We use 'no-cache' to make sure we always get the latest news
      const response = await fetch(SCRIPT_URL, { redirect: 'follow' });
      const data = await response.json();
      
      if (!data || data.length === 0 || data.error) {
         loader.innerHTML = "Sheet is empty or Tab Name is wrong.";
         return;
      }

      cont.innerHTML = data.map((s, i) => {
        let link = s.StoryLink || "https://radiobayelsa.info";
        if(!link.startsWith('http')) link = 'https://' + link;

        return `
          <div class="slide" onclick="window.open('${link}', '_top')">
            <img src="${s.ImageURL}" alt="news">
            <div class="overlay"></div>
            <div class="content">
              <span class="cat-badge">Radio Bayelsa</span>
              <div class="headline">${s.Headline}</div>
              <div class="summary-text">${s.Summary}</div>
              <div style="font-size:11px; opacity:0.8; font-weight:bold;">READ FULL STORY â†’</div>
            </div>
          </div>`;
      }).join('');

      loader.style.display = 'none';
      startSlider(data.length);

    } catch (err) {
      console.error(err);
      loader.innerHTML = "Check Apps Script: Deployment must be set to 'Anyone'.";
    }
  }

  let idx = 0;
  function startSlider(count) {
    if (count <= 1) return;
    setInterval(() => {
      idx = (idx + 1) % count;
      document.getElementById('slides').style.transform = `translateX(-${idx * 100}%)`;
    }, 6000); 
  }

  window.onload = loadNews;
</script>
